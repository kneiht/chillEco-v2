
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Test Page</title>
  <style>
    body { font-family: sans-serif; margin: 2em; background-color: #f4f4f9; }
    h1, h2 { color: #333; }
    div { background-color: #fff; border: 1px solid #ddd; padding: 1em; margin-bottom: 1em; border-radius: 5px; }
    button { padding: 0.5em 1em; border: none; background-color: #007bff; color: white; border-radius: 3px; cursor: pointer; }
    button:hover { background-color: #0056b3; }
    input { padding: 0.5em; margin-right: 0.5em; border: 1px solid #ccc; border-radius: 3px; }
    pre { background-color: #eee; padding: 1em; border-radius: 3px; white-space: pre-wrap; word-wrap: break-word; }
    form { margin-bottom: 1em; }
  </style>
</head>
<body>

  <h1>API Test Page</h1>

  <!-- Get All Users -->
  <div>
    <h2>Get All Users</h2>
    <button id="get-users-btn">Fetch Users</button>
    <h3>Result:</h3>
    <pre id="get-users-result"></pre>
  </div>

  <!-- Create User -->
  <div>
    <h2>Create User</h2>
    <form id="create-user-form">
      <input type="text" id="create-name" placeholder="Name" required>
      <input type="email" id="create-email" placeholder="Email" required>
      <input type="password" id="create-password" placeholder="Password" required>
      <button type="submit">Create User</button>
    </form>
    <h3>Result:</h3>
    <pre id="create-user-result"></pre>
  </div>

  <!-- Update User -->
  <div>
    <h2>Update User</h2>
    <form id="update-user-form">
      <input type="text" id="update-id" placeholder="User ID" required>
      <input type="text" id="update-name" placeholder="New Name">
      <input type="email" id="update-email" placeholder="New Email">
      <button type="submit">Update User</button>
    </form>
    <h3>Result:</h3>
    <pre id="update-user-result"></pre>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const API_URL = 'http://localhost:3000';

      // --- Get All Users ---
      const getUsersBtn = document.getElementById('get-users-btn');
      const getUsersResult = document.getElementById('get-users-result');
      getUsersBtn.addEventListener('click', async () => {
        try {
          const response = await fetch(`${API_URL}/users`);
          const data = await response.json();
          getUsersResult.textContent = JSON.stringify(data, null, 2);
        } catch (error) {
          getUsersResult.textContent = `Error: ${error.message}`;
        }
      });

      // --- Create User ---
      const createUserForm = document.getElementById('create-user-form');
      const createUserResult = document.getElementById('create-user-result');
      createUserForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const name = document.getElementById('create-name').value;
        const email = document.getElementById('create-email').value;
        const password = document.getElementById('create-password').value;
        try {
          const response = await fetch(`${API_URL}/users`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, email, password }),
          });
          const data = await response.json();
          createUserResult.textContent = JSON.stringify(data, null, 2);
          getUsersBtn.click(); // Refresh user list
        } catch (error) {
          createUserResult.textContent = `Error: ${error.message}`;
        }
      });

      // --- Update User ---
      const updateUserForm = document.getElementById('update-user-form');
      const updateUserResult = document.getElementById('update-user-result');
      updateUserForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const id = document.getElementById('update-id').value;
        const name = document.getElementById('update-name').value;
        const email = document.getElementById('update-email').value;
        
        const body = {};
        if (name) body.name = name;
        if (email) body.email = email;

        try {
          const response = await fetch(`${API_URL}/users/${id}`, {
            method: 'PATCH',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(body),
          });
          const data = await response.json();
          updateUserResult.textContent = JSON.stringify(data, null, 2);
          getUsersBtn.click(); // Refresh user list
        } catch (error) {
          updateUserResult.textContent = `Error: ${error.message}`;
        }
      });
    });
  </script>

</body>
</html>
